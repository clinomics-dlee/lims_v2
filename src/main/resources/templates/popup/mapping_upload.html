<div class="modal fade" id="modal-mapping-upload">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">Mapping File Upload</h4>
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
			</div>
			<div class="modal-body">
				<form id="frm_popup_mapping_upload" name="frm_popup_mapping_upload" method="POST" enctype="multipart/form-data">
					<div class="form-group row m-b-12">
						<label class="col-form-label col-md-4">Mapping No. *</label>
						<div class="col-xs-push-0">
							<input type="text" id="mappingNo" name="mappingNo" class="form-control"/>
						</div>
					</div>
					<div class="form-group row m-b-12">
						<label class="col-form-label col-md-4">Mapping File *</label>
						<div class="col-xs-push-0">
							<input type="file" id="file" name="file">
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<a href="javascript:;" class="btn btn-white" data-dismiss="modal">Close</a>
				<a href="javascript:popupUpload();" class="btn btn-success">Upload</a>
			</div>
		</div>
	</div>
</div>

<script th:inline="javascript">
/* <![CDATA[ */       
function mappingUploadPopupOnload(index) {
	$("#modal-mapping-upload").modal();
}

function popupUpload() {
	if (!$('#frm_popup_mapping_upload').parsley().validate()) {
		return;	
	}

	var form = $('#frm_popup_mapping_upload')[0];
	console.log(form);
	var data = new FormData(form);
	console.log(data);
	
	$.ajax({
		enctype: 'multipart/form-data',
		url: '/exp/step2/mapping/upload',
		type: 'post',
		data : data,
		processData: false,
		contentType: false,
		beforeSend: function(xhr) {
			xhr.setRequestHeader(header, token);
		},
		success: function(data, xhr) {
			if (data.result == "00") {
				CommonMsg.save(function() {
					$("#modal-mapping-upload").modal('hide');
					UserTable.reload('_step2_grid');
				});
			} else if (!data.result.startsWith("0")) {
				CommonMsg.error(function() { });
			}
		},
		error : function(data) {
			CommonMsg.error(function() { });
		},
		complete : function() {
			
		}
	});
}
/* ]]> */
</script>
